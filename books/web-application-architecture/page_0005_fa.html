<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>page_0005</title>
    <link rel="stylesheet" href="fontiran.css">
    <!-- Add Prism CSS for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css">
    <style>
        @page {
            size: A4;
            margin: 1.5cm;
        }
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'IRANSansX', 'Tahoma', 'Arial', sans-serif;
            line-height: 1.5;
            background-color: #f8f9fa;
            /* A4 size enforcement */
            width: 21cm;
            height: 29.7cm;
        }
        .container {
            width: 18cm; /* A4 width minus margins */
            min-height: 26.7cm; /* A4 height minus margins */
            background-color: white;
            padding: 1cm;
            box-sizing: border-box;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
        }
        .persian-translation {
            text-align: right;
            direction: rtl;
            font-size: 1em;
            font-family: 'IRANSansX', 'Tahoma', 'Arial', sans-serif;
            margin-bottom: 20px;
            /* Don't hide any overflow text, let it flow naturally */
            overflow: visible;
        }
        /* Style for code blocks */
        pre[class*="language-"] {
            direction: ltr;
            text-align: left;
            border-radius: 5px;
            margin: 1em 0;
            font-size: 0.9em;
            overflow-x: auto;
            white-space: pre-wrap;
        }
        code {
            direction: ltr;
            font-family: 'Courier New', Courier, monospace;
            background-color: #f5f5f5;
            border-radius: 3px;
            padding: 2px 4px;
        }
        .page-images {
            margin: 1cm 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1cm;
        }
        .page-image {
            max-width: 100%;
            height: auto;
            object-fit: contain;
        }
        .page-number {
            text-align: center;
            margin-top: 10px;
            font-size: 0.9em;
            color: #777;
        }
        @media print {
            body {
                background: none;
                width: 21cm;
                height: 29.7cm;
            }
            .container {
                box-shadow: none;
                padding: 1cm;
                height: auto;
                min-height: auto;
            }
            /* Page break utility */
            .page-break {
                page-break-before: always;
            }
            /* Ensure code blocks print with background colors */
            pre[class*="language-"] {
                print-color-adjust: exact;
                -webkit-print-color-adjust: exact;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div dir='rtl' class='persian-translation'><p><b>فهرست</b></p>
<p>مقدمه x</p>
<p>1. پیشگفتار . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . x</p>
<p>2. چرا جداسازی از زیرساخت آنقدر مهم است؟ . . . . . . . xi</p>
<p>3. این کتاب برای چه کسانی است؟ . . . . . . . . . . . . . . . . . . . . . . . . . . . xii</p>
<p>4. کلیاتی از محتوا . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xii</p>
<p>5. پروژه دمو همراه . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xiii</p>
<p>6. درباره نویسنده . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xiv</p>
<p>7. سپاسگزاری . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xiv</p>
<p>8. تغییرات . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xv</p>
<p>8.1. 15 آوریل 2020 (نسخه اولیه) . . . . . . . . . . . . . . . . . . . . xv</p>
<p>8.2. 23 آوریل 2020 . . . . . . . . . . . . . . . . . . . . . . . . . . . xv</p>
<p>8.3. 1 مه 2020 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xvi</p>
<p>8.4. 6 مه 2020 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xvi</p>
<p>8.5. 29 مه 2020 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xvi</p>
<p>8.6. 4 ژوئن 2020 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xvii</p>
<p>8.7. 12 ژوئن 2020 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xvii</p>
<p>8.8. 17 ژوئن 2020 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xvii</p>
<p>8.9. 22 ژوئن 2020 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xviii</p>
<p>8.10. 26 ژوئن 2020 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xviii</p>
<p>8.11. 1 ژوئیه 2020 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xviii</p>
<p>8.12. 6 ژوئیه 2020 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xviii</p>
<p>8.13. 8 ژوئیه 2020 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xviii</p>
<p>بخش اول. جداسازی از زیرساخت 1</p>
<p>1. مقدمه 2</p>
<p>1.1. قانون شماره 1: هیچ وابستگی به سیستم‌های خارجی . . . . . . . . . . 3</p>
<p>1.2. تجرید . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5</p>
<p>iv</p>

</div>
        
        
        
        <div class="page-number">
            5
        </div>
    </div>
    
    <!-- Add Prism JS for syntax highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script>
        // Initialize Prism highlighting
        document.addEventListener('DOMContentLoaded', (event) => {
            /* Add line-numbers class to all pre elements if not already there */
            document.querySelectorAll('pre').forEach(block => {
                if (!block.classList.contains('line-numbers')) {
                    block.classList.add('line-numbers');
                }
                
                /* If language class is not specified, add 'language-clike' as default */
                let hasLanguageClass = false;
                block.classList.forEach(className => {
                    if (className.startsWith('language-')) {
                        hasLanguageClass = true;
                    }
                });
                
                if (!hasLanguageClass) {
                    block.classList.add('language-clike');
                }
                
                /* Ensure code elements inside pre also have the correct language class */
                const codeElement = block.querySelector('code');
                if (codeElement) {
                    if (!hasLanguageClass) {
                        codeElement.classList.add('language-clike');
                    } else {
                        /* Copy the language class from pre to code if code doesn't have it */
                        block.classList.forEach(className => {
                            if (className.startsWith('language-') && !codeElement.classList.contains(className)) {
                                codeElement.classList.add(className);
                            }
                        });
                    }
                }
            });
            
            /* Re-highlight all code blocks */
            if (window.Prism) {
                Prism.highlightAll();
            }
            
            /* Smart image scaling based on page content */
            const container = document.querySelector('.container');
            const textElement = document.querySelector('.persian-translation');
            const imageContainer = document.querySelector('.page-images');
            
            if (imageContainer && textElement) {
                const images = imageContainer.querySelectorAll('.page-image');
                if (images.length > 0) {
                    /* Calculate available space */
                    const containerHeight = container.clientHeight;
                    const textHeight = textElement.clientHeight;
                    const pageNumberHeight = document.querySelector('.page-number').clientHeight;
                    const availableHeight = containerHeight - textHeight - pageNumberHeight - 40; /* Extra margins */
                    
                    /* Estimate total height of images */
                    let totalImageHeight = 0;
                    images.forEach(img => {
                        /* Wait for image to load to get accurate height */
                        img.onload = function() {
                            /* Get natural aspect ratio */
                            const ratio = img.naturalWidth / img.naturalHeight;
                            /* Calculate height based on max width */
                            const estimatedHeight = (img.clientWidth / ratio);
                            totalImageHeight += estimatedHeight + 40; /* Add gap */
                            
                            /* Check if images don't fit */
                            if (totalImageHeight > availableHeight) {
                                /* Try to scale down by up to 30% */
                                const scaleFactor = Math.max(0.7, availableHeight / totalImageHeight);
                                
                                /* If even with 30% reduction it doesn't fit, set page-break */
                                if (scaleFactor < 0.7) {
                                    imageContainer.classList.add('page-break');
                                } else {
                                    /* Scale images to fit */
                                    images.forEach(i => {
                                        i.style.maxWidth = (scaleFactor * 100) + '%';
                                    });
                                }
                            }
                        };
                        
                        /* Force layout calculation in case image is already loaded */
                        if (img.complete) {
                            img.onload();
                        }
                    });
                }
            }
        });
    </script>
</body>
</html>