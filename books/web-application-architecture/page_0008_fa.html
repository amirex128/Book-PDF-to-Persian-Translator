<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>page_0008</title>
    <link rel="stylesheet" href="fontiran.css">
    <!-- Add Prism CSS for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css">
    <style>
        @page {
            size: A4;
            margin: 1.5cm;
        }
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'IRANSansX', 'Tahoma', 'Arial', sans-serif;
            line-height: 1.5;
            background-color: #f8f9fa;
            /* A4 size enforcement */
            width: 21cm;
            height: 29.7cm;
        }
        .container {
            width: 18cm; /* A4 width minus margins */
            min-height: 26.7cm; /* A4 height minus margins */
            background-color: white;
            padding: 1cm;
            box-sizing: border-box;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
        }
        .persian-translation {
            text-align: right;
            direction: rtl;
            font-size: 1em;
            font-family: 'IRANSansX', 'Tahoma', 'Arial', sans-serif;
            margin-bottom: 20px;
            /* Don't hide any overflow text, let it flow naturally */
            overflow: visible;
        }
        /* Style for code blocks */
        pre[class*="language-"] {
            direction: ltr;
            text-align: left;
            border-radius: 5px;
            margin: 1em 0;
            font-size: 0.9em;
            overflow-x: auto;
            white-space: pre-wrap;
        }
        code {
            direction: ltr;
            font-family: 'Courier New', Courier, monospace;
            background-color: #f5f5f5;
            border-radius: 3px;
            padding: 2px 4px;
        }
        .page-images {
            margin: 1cm 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1cm;
        }
        .page-image {
            max-width: 100%;
            height: auto;
            object-fit: contain;
        }
        .page-number {
            text-align: center;
            margin-top: 10px;
            font-size: 0.9em;
            color: #777;
        }
        @media print {
            body {
                background: none;
                width: 21cm;
                height: 29.7cm;
            }
            .container {
                box-shadow: none;
                padding: 1cm;
                height: auto;
                min-height: auto;
            }
            /* Page break utility */
            .page-break {
                page-break-before: always;
            }
            /* Ensure code blocks print with background colors */
            pre[class*="language-"] {
                print-color-adjust: exact;
                -webkit-print-color-adjust: exact;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div dir='rtl' class='persian-translation'><p><b>فهرست</b></p>
<p>9. نتیجه‌گیری 226</p>
<p>9.1. کد هسته و کد زیرساخت . . . . . . . . . . . . . . . . . . . . . . . . . . 226</p>
<p>9.2. خلاصه‌ای از استراتژی . . . . . . . . . . . . . . . . . . . . . . . . . . . . 229</p>
<p>9.2.1. همه جا از تزریق وابستگی و وارونه‌سازی استفاده کنید . . . . 229</p>
<p>9.2.2. از امکان فراخوانی جهانی موارد استفاده استفاده کنید . . . . . . . . 231</p>
<p>9.3. تمرکز بر دامنه . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 233</p>
<p>9.4. تمرکز بر آزمون‌پذیری . . . . . . . . . . . . . . . . . . . . . . . . . . . . 234</p>
<p>9.5. کد کاملاً شی‌گرایانه . . . . . . . . . . . . . . . . . . . . . . . . . . . . 236</p>
<p>9.6. خلاصه . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 241</p>
<p>بخش دوم. اصول سازماندهی 243</p>
<p>10.مقدمه 244</p>
<p>11. الگوهای طراحی کلیدی 245</p>
<p>11.1. عناصر ساختاری الهام گرفته از چارچوب . . . . . . . . . . . . . . . . 245</p>
<p>11.2. موجودیت‌ها . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 246</p>
<p>11.2.1. از ثابت‌ها محافظت کنید . . . . . . . . . . . . . . . . . . . . . . . 247</p>
<p>11.2.2. به‌روزرسانی‌ها را محدود کنید . . . . . . . . . . . . . . . . . . . . . 248</p>
<p>11.2.3. تغییر حالت موجودیت را به عنوان عمل با گذرهای حالت مدل‌سازی کنید . . 249</p>
<p>11.2.4. بیش از حد به جداول فکر نکنید . . . . . . . . . . . . . . . . . . . 250</p>
<p>11.2.5. رویدادهای دامنه را ثبت کنید . . . . . . . . . . . . . . . . . . . . 251</p>
<p>11.3. انبارها . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 252</p>
<p>11.4. سرویس‌های کاربردی . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 254</p>
<p>11.4.1. شناسه یک موجودیت جدید را برگردانید . . . . . . . . . . . . . . 257</p>
<p>11.4.2. ورودی باید به عنوان داده نوع اولیه تعریف شود . . . . . . . . . . 258</p>
<p>11.4.3. ورودی را درون اشیاء دستور بپیچانید . . . . . . . . . . . . . . . . 258</p>
<p>11.4.4. ورودی اولیه را به اشیاء دامنه تبدیل کنید . . . . . . . . . . . . 260</p>
<p>11.4.5. اطلاعات زمینه را به عنوان آرگومان‌های اضافی اضافه کنید . . . . . 263</p>
<p>11.4.6. در هر فراخوانی سرویس کاربردی، فقط یک موجودیت را ذخیره کنید . . . . . 264</p>
<p>11.4.7. وظایف ثانویه را به یک مشترک رویداد دامنه منتقل کنید . . . . . . 264</p>
<p>11.5. مشترکان رویداد . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 267</p>
<p>11.5.1. مشترکان را به ماژولی که در آن اثر تولید می‌کنند، منتقل کنید . . . . . . . . . . . . . . . . . . . . . . . . 269</p>
<p>11.5.2. به یک سرویس کاربردی واگذار کنید . . . . . . . . . . . . . . . . . . 270</p>
<p>vii</p>
</div>
        
        
        
        <div class="page-number">
            8
        </div>
    </div>
    
    <!-- Add Prism JS for syntax highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script>
        // Initialize Prism highlighting
        document.addEventListener('DOMContentLoaded', (event) => {
            /* Add line-numbers class to all pre elements if not already there */
            document.querySelectorAll('pre').forEach(block => {
                if (!block.classList.contains('line-numbers')) {
                    block.classList.add('line-numbers');
                }
                
                /* If language class is not specified, add 'language-clike' as default */
                let hasLanguageClass = false;
                block.classList.forEach(className => {
                    if (className.startsWith('language-')) {
                        hasLanguageClass = true;
                    }
                });
                
                if (!hasLanguageClass) {
                    block.classList.add('language-clike');
                }
                
                /* Ensure code elements inside pre also have the correct language class */
                const codeElement = block.querySelector('code');
                if (codeElement) {
                    if (!hasLanguageClass) {
                        codeElement.classList.add('language-clike');
                    } else {
                        /* Copy the language class from pre to code if code doesn't have it */
                        block.classList.forEach(className => {
                            if (className.startsWith('language-') && !codeElement.classList.contains(className)) {
                                codeElement.classList.add(className);
                            }
                        });
                    }
                }
            });
            
            /* Re-highlight all code blocks */
            if (window.Prism) {
                Prism.highlightAll();
            }
            
            /* Smart image scaling based on page content */
            const container = document.querySelector('.container');
            const textElement = document.querySelector('.persian-translation');
            const imageContainer = document.querySelector('.page-images');
            
            if (imageContainer && textElement) {
                const images = imageContainer.querySelectorAll('.page-image');
                if (images.length > 0) {
                    /* Calculate available space */
                    const containerHeight = container.clientHeight;
                    const textHeight = textElement.clientHeight;
                    const pageNumberHeight = document.querySelector('.page-number').clientHeight;
                    const availableHeight = containerHeight - textHeight - pageNumberHeight - 40; /* Extra margins */
                    
                    /* Estimate total height of images */
                    let totalImageHeight = 0;
                    images.forEach(img => {
                        /* Wait for image to load to get accurate height */
                        img.onload = function() {
                            /* Get natural aspect ratio */
                            const ratio = img.naturalWidth / img.naturalHeight;
                            /* Calculate height based on max width */
                            const estimatedHeight = (img.clientWidth / ratio);
                            totalImageHeight += estimatedHeight + 40; /* Add gap */
                            
                            /* Check if images don't fit */
                            if (totalImageHeight > availableHeight) {
                                /* Try to scale down by up to 30% */
                                const scaleFactor = Math.max(0.7, availableHeight / totalImageHeight);
                                
                                /* If even with 30% reduction it doesn't fit, set page-break */
                                if (scaleFactor < 0.7) {
                                    imageContainer.classList.add('page-break');
                                } else {
                                    /* Scale images to fit */
                                    images.forEach(i => {
                                        i.style.maxWidth = (scaleFactor * 100) + '%';
                                    });
                                }
                            }
                        };
                        
                        /* Force layout calculation in case image is already loaded */
                        if (img.complete) {
                            img.onload();
                        }
                    });
                }
            }
        });
    </script>
</body>
</html>