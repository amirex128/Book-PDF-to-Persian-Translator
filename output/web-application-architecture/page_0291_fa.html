<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>صفحه 291</title>
    <link rel="stylesheet" href="fontiran.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet" />
    <style>
        @page {
            size: A4;
            margin: 2cm;
        }
        body {
            font-family: IRANSansX, Tahoma, Arial, sans-serif;
            line-height: 1.8;
            text-align: right;
            direction: rtl;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            background-color: white;
        }
        .chapter-content {
            margin-bottom: 20px;
            text-align: right;
            direction: rtl;
        }
        .translated-content {
            font-size: 14pt;
            margin-bottom: 15px;
            text-align: right;
            direction: rtl;
        }
        .page-images {
            text-align: center;
            margin: 20px 0;
            page-break-before: always;
        }
        .page-image {
            margin: 10px 0;
            text-align: center;
        }
        .page-image img {
            max-width: 100%;
            height: auto;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .code-block {
            direction: ltr;
            text-align: left;
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', Courier, monospace;
        }
        .english-text {
            direction: ltr;
            text-align: left;
            display: inline-block;
        }
        .heading {
            color: #2c3e50;
            margin-top: 25px;
            margin-bottom: 15px;
            text-align: right;
            direction: rtl;
        }
        .paragraph {
            margin-bottom: 15px;
            text-align: right;
            direction: rtl;
        }
        ul, ol {
            padding-right: 20px;
            padding-left: 0;
            text-align: right;
            direction: rtl;
        }
        li {
            margin-bottom: 10px;
            text-align: right;
            direction: rtl;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            text-align: right;
            direction: rtl;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: right;
            direction: rtl;
        }
        th {
            background-color: #f8f9fa;
        }
        @media print {
            body {
                margin: 0;
                padding: 0;
            }
            .page-break {
                page-break-before: always;
            }
        }
    </style>
</head>
<body>
    <div class="chapter-content">
        <div class="translated-content">
            <div>
    <p>the current user ID is part of the command data:
    service را به عنوان یکی از dependencies آن (به Listing 11.16 مراجعه کنید). باید توسط interface آن تزریق شود.</p>
    <p>Listing 11.19 نشان می‌دهد که چگونه شما یک event subscriber را برای رویداد OrderFullyDelivered ثبت می‌کنید.</p>
    <p>آن‌ها را در یک database ذخیره کنید، یا چیزی شبیه به آن. infrastructure-specific event subscribers نیازی به واگذاری کار خود به یک application service ندارند. در واقع، نمی‌توانند، زیرا یک application service نمی‌تواند هیچ کار infrastructureای انجام دهد. قرار است core code باشد. بنابراین با event subscribers در سطح infrastructure شما فقط هر کاری را که باید در داخل خود event subscriber انجام دهید. البته، شما همیشه می‌توانید مقداری از کار را به سایر services (infrastructure) که به عنوان constructor arguments از event subscriber تزریق می‌کنید، واگذار کنید.</p>
    <h4><strong>11.6. Read models</strong></h4>
    <p>در حالی که application services با entities، که write models هستند، سروکار دارند، یک client که به اطلاعاتی از یک entity نیاز دارد، نباید خود entity را استفاده کند، بلکه باید از یک Read model اختصاصی استفاده کند. read models های داخلی و خارجی وجود دارد (که اغلب view models نامیده می‌شوند، به بخش 11.6.3 مراجعه کنید). بیایید با read models های داخلی شروع کنیم.</p>
    <h4><strong>11.6.1. Use internal read models when you need information</strong></h4>
    <p>با توجه به یک client و نیاز آن به اطلاعات، با تعریف یک نوع جدید از object شروع کنید که بتواند این اطلاعات را ارائه دهد. به عنوان مثال، InvoicingService قصد دارد یک invoice برای یک order ایجاد کند، بنابراین باید چند چیز در مورد order بداند. در InvoicingService طوری عمل کنید که گویی از قبل وجود دارد (به Listing 11.20 مراجعه کنید).</p>
    <p>Listing 11.20. InvoicingService طوری عمل می‌کند که گویی یک Order read model از قبل وجود دارد.</p>
    <pre><code class="language-php">
final class InvoicingService
{
    // ...
    public function createInvoiceForOrder(OrderId $orderId)
    {
        // ...
        $invoice = Invoice::create(
</code></pre>
</div>

        </div>
    </div>
    <div class="page-images">
        
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            if (window.Prism) {
                Prism.highlightAll();
            }
        });
    </script>
</body>
</html>