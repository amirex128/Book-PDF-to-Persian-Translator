<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>صفحه 230</title>
    <link rel="stylesheet" href="fontiran.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet" />
    <style>
        @page {
            size: A4;
            margin: 2cm;
        }
        body {
            font-family: IRANSansX, Tahoma, Arial, sans-serif;
            line-height: 1.8;
            text-align: right;
            direction: rtl;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            background-color: white;
        }
        .chapter-content {
            margin-bottom: 20px;
            text-align: right;
            direction: rtl;
        }
        .translated-content {
            font-size: 14pt;
            margin-bottom: 15px;
            text-align: right;
            direction: rtl;
        }
        .page-images {
            text-align: center;
            margin: 20px 0;
            page-break-before: always;
        }
        .page-image {
            margin: 10px 0;
            text-align: center;
        }
        .page-image img {
            max-width: 100%;
            height: auto;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .code-block {
            direction: ltr;
            text-align: left;
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', Courier, monospace;
        }
        .english-text {
            direction: ltr;
            text-align: left;
            display: inline-block;
        }
        .heading {
            color: #2c3e50;
            margin-top: 25px;
            margin-bottom: 15px;
            text-align: right;
            direction: rtl;
        }
        .paragraph {
            margin-bottom: 15px;
            text-align: right;
            direction: rtl;
        }
        ul, ol {
            padding-right: 20px;
            padding-left: 0;
            text-align: right;
            direction: rtl;
        }
        li {
            margin-bottom: 10px;
            text-align: right;
            direction: rtl;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            text-align: right;
            direction: rtl;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: right;
            direction: rtl;
        }
        th {
            background-color: #f8f9fa;
        }
        @media print {
            body {
                margin: 0;
                padding: 0;
            }
            .page-break {
                page-break-before: always;
            }
        }
    </style>
</head>
<body>
    <div class="chapter-content">
        <div class="translated-content">
            <div>
    <h3><strong>8. Validation</strong></h3>
    <pre><code class="language-php">
public function order(
    string $bookId,
    int $quantity,
    /* ... */
): OrderId {
    $quantityAvailable = $this->stockRepository
        ->numberOfAvailableBooks($bookId);
    if ($quantityAvailable &lt; $quantity) {
        // What to do here?
    }
    // ...
}
</code></pre>
    <p>
        این اساساً همان کد است، با این تفاوت که ما واقعاً نمی‌دانیم اگر متوجه شدیم که quantity موجود کافی نیست، چه کاری باید انجام دهیم. ما نمی‌توانیم یک form error از نوعی را برگردانیم. application service قرار است حتی در یک نوع application متفاوت نیز مفید باشد.
    </p>
    <p>
        ما ممکن است بازگرداندن نوعی object "result" مستقل از زیرساخت را در نظر بگیریم. هنگامی که هر نوع مشکلی وجود داشته باشد، می‌توانیم یک object از نوع Error را برگردانیم و زمانی که همه چیز خوب است، یک OrderId را برمی‌گردانیم. اگرچه در برخی از زبان‌های برنامه‌نویسی می‌توانید این کار را به راحتی انجام دهید، اما زبان‌های شیءگرا عموماً برای این کار مناسب نیستند. روش سنتی برای نشان دادن موفقیت‌آمیز بودن یک متد این است که هیچ چیز (یا یک value object مانند OrderId در این مثال) را برنگردانید، و زمانی که مشکلی پیش می‌آید یک exception پرتاب کنید.
    </p>
    <p>
        ما می‌توانیم exception را در controller catch کنیم و آن را به صورت دستی به یک form error map کنیم. یا می‌توانیم از قدرت objects برای انجام این کار به صورت نیمه اتوماتیک استفاده کنیم. ابتدا، ما یک راه برای تمایز exceptions معمولی از exceptions که می‌خواهیم به کاربر در مورد آنها بگوییم معرفی می‌کنیم: رابط UserErrorMessage. هر زمان که بخواهیم در مورد چیزی که اشتباه شده است با user صحبت کنیم، یک class exception سفارشی ایجاد می‌کنیم که رابط UserErrorMessage را پیاده‌سازی می‌کند.
    </p>
    <p>
        ما همچنین می‌توانیم یک base class معرفی کنیم که می‌تواند مقداری کد boilerplate را برای ما ذخیره کند (BaseUserErrorMessage). Listing 8.14 رابط و base class را نشان می‌دهد.
    </p>
    <p>210</p>
</div>

        </div>
    </div>
    <div class="page-images">
        
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            if (window.Prism) {
                Prism.highlightAll();
            }
        });
    </script>
</body>
</html>