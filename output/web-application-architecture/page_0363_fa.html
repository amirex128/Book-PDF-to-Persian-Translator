<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>صفحه 363</title>
    <link rel="stylesheet" href="fontiran.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet" />
    <style>
        @page {
            size: A4;
            margin: 2cm;
        }
        body {
            font-family: IRANSansX, Tahoma, Arial, sans-serif;
            line-height: 1.8;
            text-align: right;
            direction: rtl;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            background-color: white;
        }
        .chapter-content {
            margin-bottom: 20px;
            text-align: right;
            direction: rtl;
        }
        .translated-content {
            font-size: 14pt;
            margin-bottom: 15px;
            text-align: right;
            direction: rtl;
        }
        .page-images {
            text-align: center;
            margin: 20px 0;
            page-break-before: always;
        }
        .page-image {
            margin: 10px 0;
            text-align: center;
        }
        .page-image img {
            max-width: 100%;
            height: auto;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .code-block {
            direction: ltr;
            text-align: left;
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', Courier, monospace;
        }
        .english-text {
            direction: ltr;
            text-align: left;
            display: inline-block;
        }
        .heading {
            color: #2c3e50;
            margin-top: 25px;
            margin-bottom: 15px;
            text-align: right;
            direction: rtl;
        }
        .paragraph {
            margin-bottom: 15px;
            text-align: right;
            direction: rtl;
        }
        ul, ol {
            padding-right: 20px;
            padding-left: 0;
            text-align: right;
            direction: rtl;
        }
        li {
            margin-bottom: 10px;
            text-align: right;
            direction: rtl;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            text-align: right;
            direction: rtl;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: right;
            direction: rtl;
        }
        th {
            background-color: #f8f9fa;
        }
        @media print {
            body {
                margin: 0;
                padding: 0;
            }
            .page-break {
                page-break-before: always;
            }
        }
    </style>
</head>
<body>
    <div class="chapter-content">
        <div class="translated-content">
            <div>
    <p>1. شما می‌توانید یک hierarchy از containers ایجاد کنید، به عنوان مثال. TestServiceContainer
        از DevelopmentServiceContainer گسترش می‌یابد که از یک ServiceContainer abstract گسترش می‌یابد، که دارای یک زیر class از ProductionServiceContainer است.
    </p>
    <p>2. Factory methods باید در صورت امکان private باشند.</p>
    <p>3. در داخل hierarchy از containers، شما می‌توانید بخش‌هایی را با تعریف methods محافظت شده (abstract) override کنید. این همچنین به شما اجازه می‌دهد که در صورت نیاز (به عنوان مثال، در production ممکن است the EventDispatcher یک service خصوصی باشد، اما هنگام تست کردن، ممکن است public باشد) دامنه‌ها را برای testing گسترش دهید.
    </p>
    <p>4. Services را به عنوان objects stateless تعریف کنید تا بتوانید هر بار که درخواست می‌شود، یک نمونه جدید را از factory method برگردانید. اگر شما باید service را stateful یا mutable کنید، مانند repositories in-memory یا event dispatcher، یا اگر instantiation باید اغلب اتفاق بیفتد، یک نمونه از service را در یک property از container نگه دارید.</p>
    <p>5. The constructor از container می‌تواند برای اجبار مقادیر configuration خاصی برای ارائه استفاده شود. توصیه می‌شود یک object configuration value تعریف کنید که پیش‌فرض‌های منطقی را ارائه می‌دهد.
        بازگشت به مثال: ما می‌خواهیم نشان دهیم که، هنگامی که یک order ایجاد شده است، customer یک ایمیل تأیید order دریافت می‌کند. Listing 14.13 نشان می‌دهد که یک test مانند این چگونه است.
    </p>
    <p>Listing 14.13. استفاده از the TestServiceContainer در یک test.</p>
    <pre><code class="language-php">
public function the_customer_receives_an_order_confirmation_mail(): void
{
    $container = new TestServiceContainer();
    $orderId = $container->application()->createOrder(
        new CreateOrder(2, 1, 'matthiasnoback@gmail.com')
    );
    // TODO verify that an email was sent
}
</code></pre>
    <p>ما هنوز یک event subscriber را که می‌تواند ایمیل را ارسال کند، تنظیم نکرده‌ایم، بنابراین بیایید این کار را اکنون انجام دهیم (به Listing 14.14 مراجعه کنید).</p>
</div>

        </div>
    </div>
    <div class="page-images">
        
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            if (window.Prism) {
                Prism.highlightAll();
            }
        });
    </script>
</body>
</html>