# Book PDF to Persian Translator

این پروژه شامل اسکریپت‌هایی برای:
1. استخراج متن و تصاویر از کتاب‌های PDF صفحه به صفحه
2. ترجمه متن استخراج شده به فارسی با استفاده از هوش مصنوعی Google Gemini
3. تبدیل صفحات ترجمه شده به فایل PDF فارسی با فونت ایران سنس و تصاویر اصلی
4. حذف فایل‌های ترجمه شده در صورت نیاز

## نصب

1. نصب وابستگی‌های مورد نیاز:
```
pip install -r requirements.txt
```

2. نصب wkhtmltopdf (برای تبدیل HTML به PDF):
   - دانلود از [وب‌سایت رسمی wkhtmltopdf](https://wkhtmltopdf.org/downloads.html)
   - نصب آن روی سیستم خود
   - اطمینان از افزوده شدن آن به PATH سیستم

3. قرار دادن فایل‌های PDF کتاب در پوشه `books` (در صورت عدم وجود، آن را ایجاد کنید)

4. فونت ایران سنس:
   - فونت ایران سنس در پوشه `assets/Webfonts` قرار دارد و به صورت خودکار در فایل‌های HTML استفاده می‌شود
   - برای PDF نهایی نیز از همین فونت استفاده می‌شود

## ویژگی‌های اصلی

- استخراج و حفظ تصاویر موجود در PDF اصلی
- ترجمه متن به فارسی با حفظ تصاویر اصلی در خروجی نهایی
- پشتیبانی از فونت ایران سنس برای نمایش بهتر متن فارسی
- تبدیل خودکار به PDF با صفحه‌آرایی مناسب

## نحوه استفاده

### پردازش کامل (استخراج، ترجمه و تبدیل به PDF)

برای انجام کل فرایند با یک دستور، از اسکریپت `pdf_translate_all.py` استفاده کنید:

```
python pdf_translate_all.py
```

این اسکریپت:
- تمام فایل‌های PDF موجود در پوشه `books` را پردازش می‌کند
- برای هر PDF، یک پوشه با همان نام ایجاد می‌کند (اگر از قبل وجود داشته باشد، آن را حذف و دوباره ایجاد می‌کند)
- فایل‌های فونت ایران سنس را به پوشه خروجی کپی می‌کند
- متن و تصاویر هر صفحه را استخراج می‌کند
- هر صفحه را به فارسی ترجمه و به صورت فایل HTML با فونت ایران سنس و تصاویر اصلی ذخیره می‌کند
- همه فایل‌های HTML را به یک PDF واحد با پسوند "_fatsi" تبدیل می‌کند
- به فایل PDF بعدی می‌رود و تمام مراحل را تکرار می‌کند

### خروجی تمیز و ساده
- فایل‌های HTML و PDF تولید شده شامل متن ترجمه شده فارسی، تصاویر اصلی و شماره صفحه هستند
- متن اصلی انگلیسی حذف شده است
- قالب‌بندی ساده و تمیز با فونت ایران سنس

پارامترهای اختیاری:
- `--api-key`: کلید API جمینی (پیش‌فرض: کلید از پیش تنظیم شده)
- `--books-dir`: مسیر پوشه حاوی فایل‌های PDF (پیش‌فرض: `./books`)
- `--limit`: حداکثر تعداد صفحات برای پردازش از هر کتاب (برای آزمایش مفید است)
- `--no-pdf`: بدون تبدیل نهایی به PDF (فقط فایل‌های HTML ایجاد می‌شوند)

مثال:
```
python pdf_translate_all.py --limit 10 --api-key "YOUR_GEMINI_API_KEY"
```

### پردازش جداگانه استخراج و ترجمه

اگر می‌خواهید مراحل را جداگانه انجام دهید، هنوز می‌توانید از اسکریپت‌های زیر استفاده کنید:

#### استخراج متن از PDF

```
python pdf_to_txt.py
```

#### ترجمه متن به فارسی

```
python translate_books.py
```

### حذف فایل‌های ترجمه شده

برای حذف فایل‌های ترجمه شده برای یک کتاب خاص:

```
python delete_translations.py "نام-کتاب"
```

## نکات

- اسکریپت از Google Gemini API (مدل gemini-1.5-flash-8b) برای ترجمه استفاده می‌کند
- کیفیت ترجمه به مدل Gemini بستگی دارد
- برای کتاب‌های بزرگ، از پارامتر `--limit` برای آزمایش روی تعداد کمی از صفحات استفاده کنید
- اگر با محدودیت نرخ مواجه شدید، اسکریپت به مدت 60 ثانیه مکث می‌کند
- فایل‌های HTML و PDF فقط شامل متن ترجمه شده فارسی و شماره صفحه هستند
- PDF نهایی تولید شده با پسوند "_fatsi" در کنار فایل PDF اصلی ذخیره می‌شود 